## Edmonds-Karp Algorithm ğŸŸ¢ Platinum IV
ê·¸ë˜í”„ì—ì„œ ì‹œì‘ ì§€ì (source)ì—ì„œ ìœ ëŸ‰ì„ í˜ë ¤ì„œ, ë„ì°© ì§€ì (sink)ê¹Œì§€ ìœ ëŸ‰ì´ ì–¼ë§ˆë‚˜ ë„ì°©í•˜ëŠ”ì§€ ì°¾ëŠ” ì•Œê³ ë¦¬ì¦˜

ì‹œê°„ë³µì¡ë„ : O(VEÂ²)

![](https://github.com/user-attachments/assets/f3d8703f-6bda-401f-889a-458d27e8b002)

ë‹¤ìŒê³¼ ê°™ì€ ê·¸ë˜í”„ê°€ ì£¼ì–´ì¡Œë‹¤ê³  í•˜ì. ê°„ì„ ì˜ f/cì˜ fëŠ” í˜„ì¬ íë¥´ëŠ” ìœ ëŸ‰ì´ê³ (flow), cëŠ” ì´ ìš©ëŸ‰(capacity)ì´ë‹¤.  
prevëŠ” ì´ ì •ì  ì´ì „ì— ë°©ë¬¸í•œ ì •ì ì„ ë‚˜íƒ€ë‚´ëŠ” ë°°ì—´ì´ë‹¤.  
Sì—ì„œ íƒìƒ‰ì„ ì‹œì‘í•˜ê³  ì¸ì ‘í•œ ì•„ì§ ìœ ëŸ‰ì„ í˜ë¦´ ìˆ˜ ìˆëŠ”(c-f>0) 1, 3ë²ˆ ì •ì ì„ íì— ì¶”ê°€í•©ë‹ˆë‹¤.  
$\vdots$ (bfsë¼ ê°™ì•„ì„œ íŒ¨ìŠ¤)  
íê°€ ë¹„ì–´ ì¢…ë£Œí•œë‹¤.

![](https://github.com/user-attachments/assets/6730b216-1533-4936-88f2-7a3d92b22269)

ê·¸ë ‡ê²Œ ë§Œë“¤ì–´ì§„ ë°©ë¬¸ ìˆœì„œë¥¼ í†µí•´ Eì—ì„œ ë‹¤ì‹œ ëŒì•„ê°€ë©° ê²½ë¡œë¥¼ ì°¾ëŠ”ë‹¤.  
ì´ ë•Œ E -> 2 -> 1 -> S ê²½ë¡œê°€ ë°œê²¬ë˜ì—ˆê³ , ìµœëŒ€ë¡œ í˜ë¦´ ìˆ˜ ìˆëŠ” ìµœëŒ€ ìœ ëŸ‰ì´ 2ì´ê³ , ìˆœë°©í–¥ ê°„ì„ ì—ëŠ” +2ë¥¼, ì—­ë°©í–¥ ê°„ì„ ì—ëŠ” -2ë¥¼ í˜ë ¤ì¤€ë‹¤. (ì—­ë°©í–¥ì—ë„ ìœ ëŸ‰ì„ í˜ë ¤ì£¼ëŠ” ì´ìœ ëŠ” ì•„ë˜ì—ì„œ ì„¤ëª…)

![](https://github.com/user-attachments/assets/0b9eef43-ce78-49f2-bba2-75608660e4de)

prevë¥¼ ì´ˆê¸°í™”ì‹œí‚¤ê³ , ë‹¤ì‹œ Së¶€í„° ìœ ëŸ‰ì„ í˜ë¦´ ìˆ˜ ìˆëŠ” ì •ì ë“¤ë¡œ(c-f>0) bfsë¥¼ ëŒë ¤ ê²½ë¡œë¥¼ í™•ì¸í•œë‹¤.  
ì´ ë•Œ E -> 4 -> 3 -> S ê²½ë¡œê°€ ë°œê²¬ë˜ì—ˆê³ , ì´ ê²½ë¡œë¡œ ë³´ë‚¼ ìˆ˜ ìˆëŠ” ìµœëŒ€ ìœ ëŸ‰ì¸ 1ì´ê³ , ìˆœë°©í–¥ ê°„ì„ ì—ëŠ” +1ì„, ì—­ë°©í–¥ ê°„ì„ ì—ëŠ” -1ì„ í˜ë ¤ì¤€ë‹¤.

![](https://github.com/user-attachments/assets/7f98653f-5833-4d15-baa0-7f0dab8d2a6f)

ë‹¤ìŒ ë°˜ë³µì—ì„œëŠ” Sì—ì„œ Eë¡œ ìœ ëŸ‰ì„ í˜ë ¤ë³´ë‚¼ ìˆ˜ ì—†ì–´ì„œ ë°˜ë³µì„ ì¢…ë£Œí•œë‹¤.  
ìµœì¢… ê²°ê³¼ë¡œ ì´ ìœ ëŸ‰ì´ 3ì´ ë‚˜ì™”ë‹¤.

--------

ì´ë²ˆ ì„¤ëª…ì—ëŠ” ìˆœë°©í–¥ ê°„ì„ ë§Œ ì‚¬ìš©í–ˆì§€ë§Œ ì—­ë°©í–¥ ê°„ì„ ì„ ì‚¬ìš©í•´ì„œ ë” ë‚˜ì€ ê²½ë¡œë¥¼ ì°¾ëŠ” ê²½ìš°ë„ ìˆë‹¤.  
ì—­ë°©í–¥ ê°„ì„ ìœ¼ë¡œ ë” ë‚˜ì€ ê°„ì„ ì„ ì°¾ëŠ” ê²ƒì€ ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš°ì´ë‹¤.

![](https://github.com/user-attachments/assets/428951c0-c683-48e5-8b68-6c6e9169fe4b)

S -> 3 -> 2 -> E ë°©í–¥ìœ¼ë¡œ 1ë§Œí¼ì˜ ìœ ëŸ‰ì´ íë¥¸ í›„ S -> 1 -> 2 -> E ë°©í–¥ìœ¼ë¡œ 1ë§Œí¼ì˜ ìœ ëŸ‰ì´ í˜ë €ë‹¤ê³  ê°€ì •í•˜ë©´ ë‹¤ìŒ ê·¸ë¦¼ê³¼ ê°™ì•„ì§„ë‹¤.

![](https://github.com/user-attachments/assets/bd0dd2ad-6a25-4e06-b8e5-0e4818c1e924)

ì´ ìƒí™©ì—ì„œ ìˆœë°©í–¥ ê°„ì„ ë§Œ ë³´ë©´ ë”ì´ìƒ íë¥¼ ìˆ˜ ìˆëŠ” ë°©í–¥ì´ ë³´ì´ì§€ ì•Šì§€ë§Œ, ì—­ë°©í–¥ ê°„ì„ ì„ ë³´ë©´ ë‹¤ë¥´ë‹¤.  
3 -> 2ì˜ ì—­ê°„ì„ ì¸ 2 -> 3ì„ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

![](https://github.com/user-attachments/assets/6846050d-72e8-422d-b6b2-94be7229b862)

ì´ ì—­ê°„ì„ ê¹Œì§€ í¬í•¨ì‹œí‚¤ë©´, S -> 1 -> 2 -> 3 -> 4 -> E ë°©í–¥ìœ¼ë¡œ 1ë§Œí¼ì˜ ìœ ëŸ‰ì´ íë¥¼ ìˆ˜ ìˆë‹¤.  
ëª¨ë“  ìœ ëŸ‰ì´ íë¥¸ í›„ ìµœì¢… ìƒíƒœë§Œ ë†“ê³  ë³´ë©´ S -> 3 -> 4 -> E ë°©í–¥ìœ¼ë¡œ 1ë§Œí¼ì˜ ìœ ëŸ‰ì´, S -> 1 -> 2 -> E ë°©í–¥ìœ¼ë¡œ 2ë§Œí¼ì˜ ìœ ëŸ‰ì´ íë¥¸ ê²ƒê³¼ ë™ì¼í•˜ë‹¤.

[ì—°ìŠµ ë¬¸ì œ (ë°±ì¤€ 17412ë²ˆ)](https://www.acmicpc.net/problem/17412)

``` c++
/** http://boj.kr/abf5d13ef49941ca81ce5ad00ea918a9 ì œì¶œ ì½”ë“œ */
#include <bits/stdc++.h>
using namespace std;

/**
 * INF : ëŒ€ëµ 10ì–µ
 * MAX : í•´ë‹¹ ë¬¸ì œì˜ ìµœëŒ€ ì •ì ì˜ ê°œìˆ˜
 * S : source (ì‹œì‘ì )
 * E : sink (ë„ì°©ì )
 */
const int INF = 0x3f3f3f3f;
const int MAX = 400;
const int S = 0;
const int E = 1;

/**
 * c[u][v] : uì—ì„œ vë¡œì˜ ìµœëŒ€ ìš©ëŸ‰(capacity)
 * f[u][v] : uì—ì„œ vë¡œ íë¥´ëŠ” ìœ ëŸ‰(flow)
 * prv[i] : iì— ë„ë‹¬í•˜ê¸° ìœ„í•´ ë°©ë¬¸í•œ ì´ì „ ì •ì 
 * conn[u][v] : ìˆœë°©í–¥ ê°„ì„ 
 * conn[v][u] : ì—­ë°©í–¥ ê°„ì„ 
 */
int c[MAX][MAX], f[MAX][MAX], prv[MAX];
vector<vector<int>> conn(MAX);

int main() {
    ios::sync_with_stdio(0); cin.tie(0);
    int N, P; cin >> N >> P;

    /** 
     * ì •ì ì— ê°„ì„  ì¶”ê°€
     * ìµœì ì˜ ê²½ë¡œë¥¼ ì°¾ì•„ flowë¥¼ ë” í˜ë¦¬ê¸° ìœ„í•´ ì—­ë°©í–¥ ê°„ì„ ë„ ì¶”ê°€í•´ì¤˜ì•¼í•¨.
     */
    while(P--) {
        int u, v; cin >> u >> v;
        c[u-1][v-1]++;
        conn[u-1].push_back(v-1);
        conn[v-1].push_back(u-1);
    }

    /** 
     * S -> E ë¡œì˜ bfs íƒìƒ‰
     * prv[next] = cur : ì—­ì¶”ì ì„ ìœ„í•´ next -> cur ê²½ë¡œ ê¸°ë¡
     */
    int totalFlow=0;
    while(true) {
        memset(prv, -1, sizeof prv);
        queue<int> q; q.push(S);

        while(!q.empty() && prv[E]==-1) {
            int cur = q.front(); q.pop();
            for(int next:conn[cur]) {
                if(c[cur][next]-f[cur][next]>0 && prv[next]==-1) {
                    prv[next] = cur;
                    if(next==E) break;
                    q.push(next);
                }
            }
        }
        /** ë”ì´ìƒ sinkì— ë„ë‹¬ ëª»í•˜ë©´ ì¢…ë£Œ */
        if(prv[E]==-1) break;

        /** 
         * sinkë¶€í„° ì—­ì¶”ì í•˜ë©´ì„œ ìµœëŒ€ë¡œ í˜ë¦´ ìˆ˜ ìˆëŠ” flowë¥¼ ì°¾ê³ , í˜ë¦¬ê¸°
         * f[prv[i]][i] : ìˆœë°©í–¥ ê°„ì„ ì´ì–´ì„œ flowë§Œí¼ ì±„ì›Œì§
         * f[i][prv[i]] : ì—­ë°©í–¥ ê°„ì„ ì´ì–´ì„œ flowë§Œí¼ ë¹ ì§ (ë” ë‚˜ì€ ê°„ì„ ì´ ìˆëŠ”ì§€ ì°¾ê¸° ìœ„í•´ ì“°ì„)
         * 
         * c[1][2] = 
         * S -> 1 -> 2 -> E 
         */
        int flow=INF;
        for(int i=E;i!=S;i=prv[i]) {
            flow = min(flow, c[prv[i]][i]-f[prv[i]][i]);
        }
        for(int i=E;i!=S;i=prv[i]) {
            f[prv[i]][i] += flow;
            f[i][prv[i]] -= flow;
        }
        totalFlow += flow;
    }
    cout << totalFlow;
}
```
