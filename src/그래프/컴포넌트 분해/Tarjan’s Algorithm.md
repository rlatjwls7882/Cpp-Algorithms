## Tarjanβ€™s Algorithm (SCC) πΆ Platinum V

κ·Έλν”„μ—μ„ λ‚νƒ€λ‚λ” [SCC (Strongly Connected Component)](https://ko.wikipedia.org/wiki/κ°•ν•_μ—°κ²°_μ”μ†)μ„ ν•λ²μ dfsλ΅ λ½‘μ•„λ‚΄λ” μ•κ³ λ¦¬μ¦
SCC : μ„μμ λ‘ μ •μ  μ‚¬μ΄μ— μ‚¬μ΄ν΄μ΄ μ΅΄μ¬ν•΄ μ„λ΅ μ™”λ‹¤ κ°”λ‹¤ ν•  μ μλ” μ •μ λ“¤μ κ·Έλ£Ή

μ‹κ°„λ³µμ΅λ„ : O(V + E) (V : μ •μ  μ, E : κ°„μ„  μ)

![](https://github.com/user-attachments/assets/736940b8-7a30-4be8-89c1-8586b49ed4ce)

μ΄λ° κ·Έλν”„κ°€ μ£Όμ–΄μ§„λ‹¤κ³  ν•μ. μ—¬κΈ°μ„ μμ‹ μ΄ μ†ν• κ·Έλ£Ή λ²νΈλ¥Ό λ‚νƒ€λ‚΄λ” parentμ™€, μ΄λ―Έ κ·Έλ£Ήν™”ν–λ”μ§€ ν™•μΈν•λ” visited λ‘κ°μ λ°°μ—΄μ„ μ‚¬μ©ν•λ‹¤.

![](https://github.com/user-attachments/assets/e322aed2-f672-49dc-815f-1e39537e1219)

λ¨Όμ € 1λ² μ •μ λ¶€ν„° λ°©λ¬Έν•λ‹¤. 1λ² μ •μ μ„ μ¤νƒμ— λ„£κ³ , remember(ν•΄λ‹Ή μ •μ μ΄ λ°©λ¬Έ κ°€λ¥ν• κ°€μ¥ μ‘μ€ κ·Έλ£Ή λ²νΈ)κ³Ό 1λ² μ •μ μ parentμ— 1(parent[cur] = ++idx, κ·Έλ£Ήλ²νΈ 1λ²)μ„ μ €μ¥ν•λ‹¤.  
1λ² μ •μ κ³Ό μ—°κ²°λ 2λ² μ •μ μ„ λ°©λ¬Έν• μ  μ—†κΈ°μ—(parent[next]==0) λ¨Όμ € λ°©λ¬Έν•λ‹¤.

![](https://github.com/user-attachments/assets/2ca7a60c-a619-47eb-b504-d31818963458)

2λ² μ •μ μ— λ°©λ¬Έν•λ‹¤. 2λ² μ •μ μ„ μ¤νƒμ— λ„£κ³ , rememberκ³Ό 2λ² μ •μ μ parentμ— 2μ„ μ €μ¥ν•λ‹¤.  
2λ² μ •μ κ³Ό μ—°κ²°λ 3λ² μ •μ μ„ λ°©λ¬Έν• μ  μ—†κΈ°μ— λ¨Όμ € λ°©λ¬Έν•λ‹¤.

![](https://github.com/user-attachments/assets/1ccdc827-2878-4b92-8096-df30c56804d6)

3λ² μ •μ μ— λ°©λ¬Έν•λ‹¤. 3λ² μ •μ μ„ μ¤νƒμ— λ„£κ³ , rememberκ³Ό 3λ² μ •μ μ parentμ— 3μ„ μ €μ¥ν•λ‹¤.  
3λ² μ •μ κ³Ό μ—°κ²°λ 4λ² μ •μ μ„ λ°©λ¬Έν• μ  μ—†κΈ°μ— λ¨Όμ € λ°©λ¬Έν•λ‹¤.

![](https://github.com/user-attachments/assets/e80cb2b1-56e4-4ebd-9803-f6d7fe74bef1)

4λ² μ •μ μ— λ°©λ¬Έν•λ‹¤. 4λ² μ •μ μ„ μ¤νƒμ— λ„£κ³ , rememberκ³Ό 4λ² μ •μ μ parentμ— 4λ¥Ό μ €μ¥ν•λ‹¤.  
4λ² μ •μ κ³Ό μ—°κ²°λ 3λ² μ •μ μ„ λ°©λ¬Έν• μ  μμ§€λ§(parent[3]!=0), 3λ² μ •μ μ κ·Έλ£Ήμ΄ ν™•μ •λμ§€ μ•μ•κΈ°μ—(visited[next]==false) rememberμ— μ›λμ κ°’κ³Ό 4λ² μ •μ μ ν„μ¬ κ·Έλ£Ή(parent[4]) μ¤‘ μ‘μ€ κ°’μ„ μ €μ¥ν•λ‹¤.  
4λ² μ •μ κ³Ό μ—°κ²°λ 8λ² μ •μ μ„ λ°©λ¬Έν• μ  μ—†κΈ°μ— λ¨Όμ € λ°©λ¬Έν•λ‹¤.

![](https://github.com/user-attachments/assets/26b53322-acba-4509-b8f8-2b12d9def098)

8λ² μ •μ μ— λ°©λ¬Έν•λ‹¤. 8λ² μ •μ μ„ μ¤νƒμ— λ„£κ³ , rememberκ³Ό 4λ² μ •μ μ parentμ— 5λ¥Ό μ €μ¥ν•λ‹¤.  
8λ² μ •μ κ³Ό μ—°κ²°λ 8λ² μ •μ μ„ λ°©λ¬Έν• μ  μμ§€λ§, 8λ² μ •μ μ κ·Έλ£Ήμ΄ ν™•μ •λμ§€ μ•μ•κΈ°μ— rememberμ— μ›λμ κ°’κ³Ό 8λ² μ •μ μ ν„μ¬ κ·Έλ£Ή μ¤‘ μ‘μ€ κ°’μ„ μ €μ¥ν•λ‹¤.  

![](https://github.com/user-attachments/assets/e8479f11-5100-45c9-b1e2-a7907d08842d)

8λ² μ •μ μ—μ„ λ”μ΄μƒ λ°©λ¬Έν•  μ μλ” μ •μ μ΄ μ—†λ‹¤.  
rememberκ°’μ΄ μ²μ μ €μ¥ν• κ°’κ³Ό λ™μΌν•λ‹¤λ©΄(κ·Έλ£Ήμ λ€ν‘ μ •μ ) μ¤νƒμ—μ„ curκ°€ λ‚μ¬λ•κΉμ§€ λΉΌμ„ μ‚¬μ΄ν΄ λ©λ΅μ— μ €μ¥ν•κ³ , visited κ°’μ„ trueλ΅, parent κ°’μ„ rememberλ΅ μ—…λ°μ΄νΈν•λ‹¤.  
κ·Έ κ²°κ³Ό, 8λ² μ •μ λ§ κΊΌλ‚΄μ Έμ„ μ—…λ°μ΄νΈ λμ—λ‹¤.  
λ§λ“¤μ–΄μ§„ κ·Έλ£Ή(μ‚¬μ΄ν΄)μ€ νλ€μƒ‰μΌλ΅ ν‘μ‹ν•μ€λ‹¤.

![](https://github.com/user-attachments/assets/aac174e6-4d88-4c65-af4f-99465b18861b)

4λ² μ •μ μΌλ΅ λλμ•„κ°€μ„, 4λ² μ •μ μ—μ„ λ”μ΄μƒ λ°©λ¬Έν•  μ μλ” μ •μ μ΄ μ—†λ‹¤.  
rememberκ°’μ΄ μ²μ μ €μ¥ν• κ°’κ³Ό λ™μΌν•κΈ°μ— μ¤νƒμ—μ„ curκ°€ λ‚μ¬λ•κΉμ§€ λΉΌμ„ μ‚¬μ΄ν΄ λ©λ΅μ— μ €μ¥ν•κ³ , visited κ°’μ„ trueλ΅, parent κ°’μ„ rememberλ΅ μ—…λ°μ΄νΈν•λ‹¤.  
κ·Έ κ²°κ³Ό, 3λ², 4λ² μ •μ μ΄ κΊΌλ‚΄μ Έμ„ μ—…λ°μ΄νΈ λμ—λ‹¤.

![](https://github.com/user-attachments/assets/779a50b3-7202-47f7-bd46-2af82898ab2e)

3λ² μ •μ μΌλ΅ λλμ•„κ°€μ„, 3λ² μ •μ κ³Ό μ—°κ²°λ 7λ² μ •μ μ„ λ°©λ¬Έν• μ  μ—†κΈ°μ— λ°©λ¬Έν•λ‹¤. 7λ² μ •μ μ„ μ¤νƒμ— λ„£κ³ , rememberκ³Ό 7λ² μ •μ μ parentμ— 6μ„ μ €μ¥ν•λ‹¤.  

![](https://github.com/user-attachments/assets/3b866c15-d718-4483-bdc5-758b47b57947)

6λ² μ •μ μ— λ°©λ¬Έν•λ‹¤. 6λ² μ •μ μ„ μ¤νƒμ— λ„£κ³ , rememberκ³Ό 6λ² μ •μ μ parentμ— 7μ„ μ €μ¥ν•λ‹¤.
6λ² μ •μ κ³Ό μ—°κ²°λ 7λ² μ •μ μ„ λ°©λ¬Έν• μ  μμ§€λ§, 7λ² μ •μ μ κ·Έλ£Ήμ΄ ν™•μ •λμ§€ μ•μ•κΈ°μ— rememberμ— μ›λμ κ°’κ³Ό 7λ² μ •μ μ ν„μ¬ κ·Έλ£Ή μ¤‘ μ‘μ€ κ°’μ„ μ €μ¥ν•λ‹¤.  
rememberκ°’μ΄ μ²μ μ €μ¥ν• κ°’κ³Ό λ™μΌν•μ§€ μ•κΈ°μ— λλμ•„κ°„λ‹¤.

![](https://github.com/user-attachments/assets/3cc85dbc-47cc-4aae-84a3-638ab71389d7)

7λ² μ •μ μΌλ΅ λλμ•„κ°„λ‹¤. μ—°κ²°λ 8λ² μ •μ μ€ μ΄λ―Έ κ·Έλ£Ήμ΄ λ§λ“¤μ–΄μ Έμ„ ν¨μ¤ν•λ‹¤.  
7λ² μ •μ μ—μ„ λ”μ΄μƒ λ°©λ¬Έν•  μ μλ” μ •μ μ΄ μ—†λ‹¤.  
rememberκ°’μ΄ μ²μ μ €μ¥ν• κ°’κ³Ό λ™μΌν•κΈ°μ— μ¤νƒμ—μ„ curκ°€ λ‚μ¬λ•κΉμ§€ λΉΌμ„ μ‚¬μ΄ν΄ λ©λ΅μ— μ €μ¥ν•κ³ , visited κ°’μ„ trueλ΅, parent κ°’μ„ rememberλ΅ μ—…λ°μ΄νΈν•λ‹¤.  
κ·Έ κ²°κ³Ό, 6λ², 7λ² μ •μ μ΄ κΊΌλ‚΄μ Έμ„ μ—…λ°μ΄νΈ λμ—λ‹¤.

![](https://github.com/user-attachments/assets/1d7a749c-95b7-4492-a89d-a7cae0db4cf2)

λ‡ λ²μ κ³Όμ • ν›„μ— 2λ² μ •μ κΉμ§€ λλμ•„κ°€μ„ 5λ² μ •μ μ„ λ°©λ¬Έν•λ‹¤. 2λ² μ •μ μ„ μ¤νƒμ— λ„£κ³ , rememberκ³Ό 2λ² μ •μ μ parentμ— 8λ¥Ό μ €μ¥ν•λ‹¤.  
5λ² μ •μ κ³Ό μ—°κ²°λ 1λ² μ •μ μ„ λ°©λ¬Έν• μ  μμ§€λ§, 1λ² μ •μ μ κ·Έλ£Ήμ΄ ν™•μ •λμ§€ μ•μ•κΈ°μ— rememberμ— μ›λμ κ°’κ³Ό 1λ² μ •μ μ ν„μ¬ κ·Έλ£Ή μ¤‘ μ‘μ€ κ°’μ„ μ €μ¥ν•λ‹¤.  

![](https://github.com/user-attachments/assets/e7b127c0-ac55-4de6-aedf-2ad033226978)

λ‡ λ²μ κ³Όμ • ν›„μ— 1λ² μ •μ κΉμ§€ λλμ•„κ°„λ‹¤. 1λ² μ •μ μ—μ„ λ”μ΄μƒ λ°©λ¬Έν•  μ μλ” μ •μ μ΄ μ—†λ‹¤.  
rememberκ°’μ΄ μ²μ μ €μ¥ν• κ°’κ³Ό λ™μΌν•κΈ°μ— μ¤νƒμ—μ„ curκ°€ λ‚μ¬λ•κΉμ§€ λΉΌμ„ μ‚¬μ΄ν΄ λ©λ΅μ— μ €μ¥ν•κ³ , visited κ°’μ„ trueλ΅, parent κ°’μ„ rememberλ΅ μ—…λ°μ΄νΈν•λ‹¤.  
κ·Έ κ²°κ³Ό, 1λ², 2λ², 5λ² μ •μ μ΄ κΊΌλ‚΄μ Έμ„ μ—…λ°μ΄νΈ λμ—λ‹¤.

κ·Έλ¦¬κ³  μ¤νƒμ΄ λΉ„μ–΄μκ³  λ°©λ¬Έ ν•μ§€ μ•μ€ μ •μ μ΄ μ—†μ–΄ μΆ…λ£ν•λ‹¤. (λ°©λ¬Έ μ•ν• μ •μ μ΄ μλ‹¤λ©΄ κ·Έ μ •μ μ„ rootλ΅ μ¶”κ°€ νƒμƒ‰ μ‹μ‘)

[μ—°μµ λ¬Έμ  (λ°±μ¤€ 2150λ²)](https://www.acmicpc.net/problem/2150)

``` c++
/** http://boj.kr/e132006f2a584d7a8aa3894bc4db617d μ μ¶ μ½”λ“ */
#include<bits/stdc++.h>
using namespace std;

/** 
 * MAX : μµλ€ μ •μ  κ°μ
 * visited[i] : iλ² μ •μ μ΄ ν„μ¬ μ„μμ SCCμ— ν¬ν•¨λμ—λ”μ§€ μ—¬λ¶€
 * idx : κ° μ •μ μ— ν• λ‹Ήν•λ” SCCλ²νΈ (dfs νƒμƒ‰ μμ„λ΅ SCCλ²νΈλ¥Ό ν• λ‹Ήν•΄μ„ μ •μ λ²νΈμ™€λ” λ‹¤λ¥΄κ² ν• λ‹Ήλ¨, κ°™μ€ κ°’μ„ κ°€μ§„ μ •μ λ“¤μ€ κ°™μ€ SCCμ— μ†ν•¨)
 * parent[i] : iλ² μ •μ κ³Ό κ°™μ€ SCCμ— μ†ν•λ©° κ° μ μλ” μ μΌ μ‘μ€ SCC λ²νΈ
 * conn[i][j] : iμ—μ„ jλ΅μ κ°„μ„ 
 * SCCs[i][j] : iλ²μ§Έ SCCμ jλ²μ§Έ μ •μ  (κ°κ°μ SCCλ” μ„μƒμ •λ ¬λμ–΄ λ‚νƒ€λ‚κΈ°μ— iκ°€ ν΄μλ΅ λ” μ°μ„ μμ„κ°€ λ†’μ)
 * stk : SCCλ¥Ό λ½‘μ•„λ‚΄κΈ° μ„ν•΄ μ‚¬μ©ν•λ” μ¤νƒ
 */
const int MAX = 10001;

bool visited[MAX];
int idx, parent[MAX];
vector<vector<int>> conn(MAX), SCCs;
stack<int> stk;

int dfs(int cur) {
    /** 
     * μ¤νƒμ— ν„μ¬ μ •μ  λ²νΈλ¥Ό λ„£κ³ , parent[cur]μ— SCC λ²νΈλ¥Ό κΈ°λ΅ν•¨
     * rem : ν„μ¬μ μ •μ μ—μ„ λ„λ‹¬ν•  μ μλ” κ°€μ¥ μ‘μ€ SCC λ²νΈ
     * parent[cur] :
     * SCCμ— ν¬ν•¨ μ•λμ—μ„ λ• -> ν„μ¬μ μ •μ μ— ν• λ‹Ήλ SCCλ²νΈ
     * SCCμ— ν¬ν•¨ λμ—μ„ λ• -> κ°™μ€ SCCμ— μ†ν• κ°€μ¥ μ‘μ€ SCCλ²νΈ
     */
    stk.push(cur);
    int rem = parent[cur] = ++idx;
    
    /** 
     * ν„μ¬ μ •μ μ—μ„ μ΄λ™ν•  μ μλ” μ •μ μ— λ€ν•΄:
     * ν•λ²λ„ λ°©λ¬Έν• μ μ΄ μ—†λ” μ •μ μ€ κ·Έ μ •μ μ— λ€ν•΄ dfs νƒμƒ‰μ„ ν•κ³  κ·Έ μ •μ μ—μ„ λ„λ‹¬ κ°€λ¥ν• κ°€μ¥ μ‘μ€ SCC λ²νΈλ¥Ό λ°›μ•„μ¤κ³ ,
     * λ°©λ¬Έν• μ μ€ μμ§€λ§ ν„μ¬ μ–΄λ– ν• SCCμ—λ„ μ†μ†λμ§€ μ•μ€ μ •μ μ— λ€ν•΄μ„λ” κ·Έ μ •μ μ SCC λ²νΈλ¥Ό λ°›μ•„μ¨λ‹¤.
     * prof. λ°©λ¬Έν• μ μ΄ μμ§€λ§ μ–΄λ– ν• SCCμ—λ„ μ†μ†λμ§€ μ•μ•λ‹¤λ” κ²ƒμ€ ν•΄λ‹Ή μ •μ μ—μ„ λ„λ‹¬ κ°€λ¥ν• λ‹¤λ¥Έ μ •μ κ³Όλ” κ°™μ€ SCCμ— μ†ν•  μ μ—†μμ„ λ»ν•¨
     * 
     * ν„μ¬ μ •μ λ³΄λ‹¤ λ°›μ•„μ¨ SCCλ²νΈκ°€ ν° κ²½μ° : μλ°©ν–¥ κ°„μ„ μ„ νƒ€κ³  κ°„ κ²ƒ
     * ν„μ¬ μ •μ λ³΄λ‹¤ λ°›μ•„μ¨ SCCλ²νΈκ°€ μ‘μ€ κ²½μ° : μ—­λ°©ν–¥ κ°„μ„ μ„ νƒ€κ³  κ°„ κ²ƒ -> μ‚¬μ΄ν΄μ΄ μ΅΄μ¬ν•  κ°€λ¥μ„±μ΄ μμ
     */
    for(int next:conn[cur]) {
        if(!parent[next]) rem = min(rem, dfs(next));
        else if(!visited[next]) rem = min(rem, parent[next]);
    }

    /** 
     * ν„μ¬ λ„λ‹¬ κ°€λ¥ν• κ°€μ¥ μ‘μ€ SCCλ²νΈκ°€ μκΈ° μμ‹ μΈ κ²½μ° -> μ‚¬μ΄ν΄ λ°κ²¬
     * prof. rem == parent[cur] == topμΈ κ²½μ°(μμ‹ μΌλ΅λ¶€ν„° λ„λ‹¬ν• λ‹¤λ¥Έ μ •μ μ—μ„ λ‹¤μ‹ λμ•„μ¤μ§€ λ»ν• κ²½μ°, μ‚¬μ΄ν΄ μ΅΄μ¬ X) ν¬κΈ°κ°€ 1μΈ SCC λ°κ²¬
     * prof. rem == parent[cur] != topμΈ κ²½μ°(μμ‹ μΌλ΅λ¶€ν„° λ„λ‹¬ν• λ‹¤λ¥Έ μ •μ μ—μ„ λ‹¤μ‹ λμ•„μ¨ κ²½μ°, μ‚¬μ΄ν΄ μ΅΄μ¬ O) ν¬κΈ°κ°€ 1λ³΄λ‹¤ ν° SCC λ°κ²¬
     * 
     * μ¤νƒμ—μ„ μκΈ° μμ‹ μ„ λ°κ²¬ν•  λ•κΉμ§€ λ½‘μ•„ κ°™μ€ SCCμ— μ§‘μ–΄λ„£κΈ°
     * 
     * μ§‘μ–΄λ„£μΌλ©΄μ„:
     * visited[top] = true;μ„ ν•΄μ¤μ„ SCCμ— ν¬ν•¨λμ—λ‹¤ λ§ν‚Ή
     * parent[top] = rem;μ„ ν•΄μ¤μ„ λ„λ‹¬ κ°€λ¥ν• κ°€μ¥ μ‘μ€ SCCλ²νΈλ΅ μ„¤μ •
     */
    if(rem==parent[cur]) {
        SCCs.push_back(vector<int>());
        while(true) {
            int top = stk.top(); stk.pop();
            SCCs.back().push_back(top);
            visited[top] = true;
            parent[top] = rem;
            if(top==cur) break;
        }
    }
    return rem;
}

int main() {
    ios::sync_with_stdio(0); cin.tie(0);
    int v, e; cin >> v >> e;

    // κ°„μ„  μ—°κ²°
    while(e--) {
        int a, b; cin >> a >> b;
        conn[a].push_back(b);
    }

    /** Tarjan's Algorithm μ‹μ‘ */
    for(int i=1;i<=v;i++) {
        if(!visited[i]) dfs(i);
    }
    /** Tarjan's Algorithm λ */

    for(int i=0;i<SCCs.size();i++) {
        sort(SCCs[i].begin(), SCCs[i].end());
    }
    sort(SCCs.begin(), SCCs.end());

    cout << SCCs.size() << '\n';
    for(auto SCC:SCCs) {
        for(int val:SCC) {
            cout << val << ' ';
        }
        cout << "-1\n";
    }
}
```
